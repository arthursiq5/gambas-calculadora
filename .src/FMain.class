' Gambas class file

Private NumeroAnterior As Float ' Esta variável armazenará o primeiro operando
Private operacao As String ' Essa variável armazena a operação matemática escolhida
Private numeroIsFracionado As Boolean ' Esta variável mostra se o número do visor é fracionado
Private LimparLabel As Boolean
Private UltimaOperacao As String

Private Sub clear()
  
  operacao = ""
  NumeroAnterior = 0
  numeroIsFracionado = False
  LimparLabel = True
  lblVisor.Text = "0"
  UltimaOperacao = ""
  
End

Public Sub Form_Open()
  
  clear()
  btnFechar.SetFocus()
  
End

Private Sub btnNumeroClick(digito As String)
  
  If CFloat(lblVisor.Text) == 0 Or LimparLabel == True Then
    lblVisor.Text = digito
    LimparLabel = False
  Else
    lblVisor.Text = lblVisor.Text & digito
  Endif
  UltimaOperacao = "AdicionadoNumero"
End


Public Sub btn1_Click()

  btnNumeroClick("1")

End

Public Sub btn2_Click()

  btnNumeroClick("2")

End

Public Sub btn3_Click()

  btnNumeroClick("3")

End

Public Sub btn4_Click()

  btnNumeroClick("4")

End

Public Sub btn5_Click()

  btnNumeroClick("5")

End

Public Sub btn6_Click()

  btnNumeroClick("6")

End

Public Sub btn7_Click()

  btnNumeroClick("7")

End

Public Sub btn8_Click()

  btnNumeroClick("8")

End

Public Sub btn9_Click()

  btnNumeroClick("9")

End

Public Sub btn0_Click()

  btnNumeroClick("0")

End

Public Sub btnPonto_Click()
  
  If numeroIsFracionado == False Then
    numeroIsFracionado = True
    lblVisor.Text = lblVisor.Text & "."
  Endif
  
End

Private Sub btnOperacoes(operacaoSelecionada As String)
  
  NumeroAnterior = CFloat(lblVisor.Text)
  operacao = operacaoSelecionada
  UltimaOperacao = "OperacaoMatematica"
  LimparLabel = True
  
End


Public Sub btnAdicao_Click()

  btnOperacoes("+")

End

Public Sub btnSubtracao_Click()

  btnOperacoes("-")

End

Public Sub btnMultiplicacao_Click()

  btnOperacoes("*")

End

Public Sub btnDivisao_Click()

  btnOperacoes("/")

End

Public Sub btnIgual_Click()

  If operacao == "+" Then
    lblVisor.Text = NumeroAnterior + CFloat(lblVisor.Text)
  Else If operacao == "-" Then
    lblVisor.Text = NumeroAnterior - CFloat(lblVisor.Text)
  Else If operacao == "*" Then
    lblVisor.Text = NumeroAnterior * CFloat(lblVisor.Text)
  Else If operacao == "/" Then
    lblVisor.Text = NumeroAnterior / CFloat(lblVisor.Text)
  Endif
  operacao = ""

End

Public Sub btnC_Click()

  clear()

End

Public Sub btnCE_Click()

  If UltimaOperacao == "AdicionadoNumero" Then
    LimparLabel = True
    numeroIsFracionado = False
    lblVisor.Text = "0"
  Else If UltimaOperacao == "OperacaoMatematica"
    operacao = ""
  Endif
  
  UltimaOperacao = ""

End
